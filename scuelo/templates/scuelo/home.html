{% extends "../layout.html" %}

{% block content %}
<!-- Breadcrumbs -->
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        {% for url, name in breadcrumbs %}
            <li class="breadcrumb-item {% if forloop.last %}active{% endif %}">
                {% if not forloop.last %}
                    <a href="{{ url }}">{{ name }}</a>
                {% else %}
                    {{ name }}
                {% endif %}
            </li>
        {% endfor %}
    </ol>
</nav>

<!-- School Year Toggle Button -->
<div class="school-year-toggle mb-4 text-center">
    <form method="get" action="{% url 'home' %}" class="d-inline-block">
        <label for="school_year" class="mr-2 font-weight-bold">School Year:</label>
        <select name="school_year" id="school_year" onchange="this.form.submit()" class="form-control d-inline-block" style="width: auto;">
            {% for year in all_years %}
                <option value="{{ year.id }}" {% if year == current_year %}selected{% endif %}>{{ year.nom }}</option>
            {% endfor %}
        </select>
    </form>
</div>

<!-- Quick Access Section -->
<div class="quick-access-section d-flex align-items-start">
    <div class="quick-access-panel">
        <h2>Quick Access</h2>
        <div class="quick-access-grid">
            <a href="{% url 'new_student' %}" class="quick-access-btn"><i class="fas fa-user-plus"></i> New Student</a>
            <a href="{% url 'mouvement_list' %}" class="quick-access-btn"><i class="fas fa-exchange-alt"></i> Movements</a>
            <a href="{% url 'cash_flow_report' %}" class="quick-access-btn"><i class="fas fa-chart-line"></i> Cash Flow</a>
            <a href="{% url 'uniform_payments' %}" class="quick-access-btn"><i class="fas fa-tshirt"></i> Uniforms</a>
            <a href="{% url 'late_payment_report' %}" class="quick-access-btn"><i class="fas fa-exclamation-triangle"></i> Late Payments</a>
            <a href="{% url 'school_management' %}" class="quick-access-btn"><i class="fas fa-school"></i> Manage Schools</a>
            <a href="{% url 'user_list' %}" class="quick-access-btn"><i class="fas fa-users-cog"></i> Manage Users</a>
            <a href="{% url 'offsite_students' %}" class="quick-access-btn"><i class="fas fa-user-friends"></i> Off-site Students</a>
        </div>
    </div>

    <!-- Main content with classes listing -->
    <div class="class-list-section">
        <h1 class="page-title">List of Classes</h1>
        <div class="school-container">
            {% for school, categories in data.items %}
                <div class="school-section">
                    <h2 class="school-title">{{ school.nom }}</h2>

                    {% for category, classes in categories.items %}
                        {% if classes %}
                            <div class="category-section">
                                <h3 class="category-title">{{ category }}</h3>
                                <div class="card-container">
                                    {% for item in classes %}
                                        <div class="card">
                                            <div class="card-body">
                                                <i class="card-icon fas fa-{{ item.icon }}"></i>
                                                <a href="{% url 'class_detail' item.classe.id %}" class="card-link">{{ item.classe.nom }}</a>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Styling -->
<style>
    /* Main Layout */
    .quick-access-section {
        display: flex;
        gap: 20px;
    }

    /* Quick Access Panel */
    .quick-access-panel {
        width: 300px;
        background-color: #f1f1f1;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-right: 20px;
    }

    .quick-access-panel h2 {
        font-size: 1.5rem;
        text-align: center;
        color: #333;
        margin-bottom: 15px;
    }

    .quick-access-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }

    .quick-access-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 15px;
        background-color: #007bff;
        color: white;
        font-size: 1rem;
        font-weight: bold;
        border-radius: 6px;
        transition: all 0.3s;
        text-decoration: none;
    }

    .quick-access-btn:hover {
        background-color: #0056b3;
        transform: scale(1.05);
        color: #f1f1f1;
    }

    .quick-access-btn i {
        font-size: 1.2rem;
    }

    /* Class List Section */
    .class-list-section {
        flex: 1;
    }

    .page-title {
        font-size: 2rem;
        color: #2c3e50;
        margin-bottom: 30px;
        font-weight: bold;
        text-align: center;
    }

    .school-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
    }

    .school-section {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        background-color: #f8f9fa;
        width: 100%;
        max-width: 300px;
    }

    .school-title {
        font-size: 1.5rem;
        font-weight: bold;
        color: #333;
        text-align: center;
        margin-bottom: 15px;
    }

    .category-section {
        margin-top: 15px;
    }

    .category-title {
        font-size: 1.2rem;
        color: #007bff;
        margin-bottom: 10px;
    }

    .card-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: 10px;
    }

    .card {
        background-color: #007bff;
        border-radius: 6px;
        padding: 10px;
        color: white;
        text-align: center;
    }

    .card-icon {
        font-size: 1.8rem;
        margin-bottom: 5px;
    }
</style>
{% endblock %}
